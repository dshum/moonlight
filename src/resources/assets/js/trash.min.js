jQuery.expr[":"].contains=function(t,e,a){return jQuery(t).text().toUpperCase().indexOf(a[3].toUpperCase())>=0},$(function(){var t={},e=function(t,e){var a={item:t};if(e)for(var i in e)a[i]=e[i];$.blockUI(),$('form[name="trash-form"]').ajaxSubmit({url:"/moonlight/trash/list",dataType:"json",data:a,success:function(t){$.unblockUI(),t.html&&$(".list-container").html(t.html)},error:function(t){$.unblockUI(),$.alert(t.statusText)}})},a=function(t){$('input:hidden[name="page"]').val(t),$('form[name="trash-form"]').submit()};$("body").on("keyup change","#filter",function(){var t=$(this).val();t.length>0?($('ul.items > li:not(:contains("'+t+'"))').hide(),$('ul.items > li:contains("'+t+'")').show()):$("ul.items > li").show()}),$(".search-form-links div.link").click(function(){var t=$(this).attr("item"),e=$(this).attr("name"),a=!$(this).hasClass("active");$(this).toggleClass("active"),$('.search-form-params div.block[name="'+e+'"]').toggleClass("active"),a?$('.search-form-params div.block[name="'+e+'"]').find("input, select").removeAttr("disabled"):$('.search-form-params div.block[name="'+e+'"]').find("input, select").attr("disabled","disabled"),$.post("/moonlight/search/active/"+t+"/"+e,{active:a})}),$(".search-form-params div.close").click(function(){var t=$(this).attr("item"),e=$(this).attr("name");$('.search-form-links div.link[name="'+e+'"]').removeClass("active"),$('.search-form-params div.block[name="'+e+'"]').removeClass("active"),$('.search-form-params div.block[name="'+e+'"]').find("input, select").attr("disabled","disabled"),$.post("/moonlight/search/active/"+t+"/"+e,{active:!1})}),$(".search-form-params div.block[name]:not(.active)").find("input, select").attr("disabled","disabled"),$(".search-form-params input[name].date").calendar({dateFormat:"%Y-%m-%d"}),$(".search-form-params input.one").each(function(){var t=$(this).parents("div.row"),e=$(this).attr("item"),a=$(this).attr("property"),i=$(this).outerWidth()-2;$(this).autocomplete({serviceUrl:"/moonlight/elements/autocomplete",params:{item:e},onSelect:function(e){t.find('input:hidden[name="'+a+'"]').val(e.id)},width:i,minChars:0})}),$(".search-form-params .addition.unset[property]").click(function(){var t=$(this).parents("div.row"),e=$(this).attr("property");t.find('input:hidden[name="'+e+'"]').val(""),t.find('input:text[name="'+e+'_autocomplete"]').val("")}),$("body").on("click","table.elements th span[resetorder]",function(){var t=$(this).parents("div[item]").attr("item");e(t,{resetorder:!0})}),$("body").on("click","table.elements th span[order][direction]",function(){var t=$(this).parents("div[item]").attr("item"),a=$(this).attr("order"),i=$(this).attr("direction");e(t,{order:a,direction:i})}),$("body").on("click","th.check",function(){var e=$(this).parent(),a=e.parents("table"),i=$(this).parents("div[item]"),n=i.attr("item");void 0===t[n]&&(t[n]=[]),e.hasClass("checked")?(t[n]=[],e.removeClass("checked"),a.find("tbody tr").each(function(){$(this).removeClass("checked")})):(e.addClass("checked"),a.find("tbody tr").each(function(){var e=$(this).attr("elementId");-1===t[n].indexOf(e)&&t[n].push(e),$(this).addClass("checked")})),t[n].length?(i.find(".button.restore").addClass("enabled"),i.find(".button.delete").addClass("enabled")):(i.find(".button.restore").removeClass("enabled"),i.find(".button.delete").removeClass("enabled"))}),$("body").on("click","td.check",function(){var e=$(this).parent(),a=$(this).parents("div[item]"),i=a.attr("item"),n=e.attr("elementId");void 0===t[i]&&(t[i]=[]);var r=t[i].indexOf(n);e.hasClass("checked")?(r>-1&&t[i].splice(r,1),e.removeClass("checked")):(-1===r&&t[i].push(n),e.addClass("checked")),t[i].length?(a.find(".button.restore").addClass("enabled"),a.find(".button.delete").addClass("enabled")):(a.find(".button.restore").removeClass("enabled"),a.find(".button.delete").removeClass("enabled"))}),$("body").on("click",".button.restore.enabled",function(){var t=$(this).parents("div[item]").attr("item");$.confirm(null,'.confirm[id="'+t+'_restore"]')}),$("body").on("click",".button.delete.enabled",function(){var t=$(this).parents("div[item]").attr("item");$.confirm(null,'.confirm[id="'+t+'_delete"]')}),$("body").on("click",".confirm .btn.restore",function(){var a=$(this).parents("div[item]").attr("item");$.confirmClose(),$.blockUI(),$.post("/moonlight/elements/restore",{item:a,checked:t[a]},function(t){$.unblockUI(function(){t.error?$.alert(t.error):t.restored&&e(a)})})}),$("body").on("click",".confirm .btn.remove",function(){var a=$(this).parents("div[item]").attr("item");$.confirmClose(),$.blockUI(),$.post("/moonlight/elements/delete/force",{item:a,checked:t[a]},function(t){$.unblockUI(function(){t.error?$.alert(t.error):t.deleted&&e(a)})})}),$("body").on("click","ul.pager > li[prev].active",function(){var t=$(this).parent(),e=(t.attr("item"),parseInt(t.attr("page"))-1);e<1&&(e=1),a(e)}),$("body").on("click","ul.pager > li[first].active",function(){$(this).parent().attr("item");a(1)}),$("body").on("keydown","ul.pager > li.page > input",function(t){var e=$(this).parents("ul.pager"),i=(e.attr("item"),parseInt($(this).val())),n=parseInt(e.attr("last"));13===(t.keyCode||t.which)&&(i<1&&(i=1),i>n&&(i=n),a(i))}),$("body").on("click","ul.pager > li[last].active",function(){var t=$(this).parent(),e=(t.attr("item"),t.attr("last"));a(e)}),$("body").on("click","ul.pager > li[next].active",function(){var t=$(this).parent(),e=(t.attr("item"),parseInt(t.attr("page"))+1),i=parseInt(t.attr("last"));e>i&&(e=i),a(e)})});