$(function(){"undefined"!=typeof jQuery&&(jQuery.fn.sortable=function(e){return this.each(function(){var t=$(this),n=t.data("sortable");!n&&e instanceof Object&&(n=new Sortable(this,e),t.data("sortable",n)),n&&e in n&&n[n].apply(n,[].slice.call(arguments,1))})}),$(".favorites").sortable({handle:"span.title",chosenClass:"chosen",dragClass:"dragging",onEnd:function(e){if(e.newIndex===e.oldIndex)return!1;var t=[];$(e.to).find(".elements[rubric]").each(function(){var e=$(this).attr("rubric");t.push(e)}),$.blockUI(),$.post("/moonlight/favorites/order/rubrics",{order:t},function(e){$.unblockUI()})}}),$(".elements ul").sortable({handle:"span.element",chosenClass:"chosen",dragClass:"dragging",onEnd:function(e){if(e.newIndex===e.oldIndex)return!1;var t=[];$(e.to).find("li").each(function(){var e=$(this).attr("favorite");t.push(e)}),$.blockUI(),$.post("/moonlight/favorites/order/favorites",{order:t},function(e){$.unblockUI()})}}),$("body").on("click","span.enabled[rubric]",function(){var e=$(this).parents(".elements"),t=$(this).attr("rubric");$.blockUI(),$.post("/moonlight/favorites/delete/rubric",{rubric:t},function(t){$.unblockUI(),t.error?$.alert(t.error):t.deleted&&e.fadeOut(200).remove()})}),$("span.enabled[favorite]").click(function(){var e=$(this).parents("li"),t=$(this).parents("ul"),n=$(this).parents(".elements"),r=$(this).attr("favorite");$.blockUI(),$.post("/moonlight/favorites/delete/favorite",{favorite:r},function(r){$.unblockUI(),r.error?$.alert(r.error):r.deleted&&(e.fadeOut(200).remove(),t.find("li").length||n.find("span[rubric]").addClass("enabled"))})})});